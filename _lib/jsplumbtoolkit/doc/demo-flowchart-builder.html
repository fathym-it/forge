<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>jsPlumb Toolkit - documentation</title>
        <link href="../../css/main.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="../css/main.css" rel="stylesheet">



        <link rel="stylesheet" href="../css/jsplumbtoolkit-defaults.css">
        <link rel="stylesheet" href="../css/jsplumbtoolkit-demo.css">
        <link rel="stylesheet" href="../css/jsplumb-doc.css">
    </head>

    <body>

        <div class="jtk-header">
    <a class="jtk-logo" href="../index.html"><img src="../img/logo-medium-jsplumb.png"></a>

    <div class="jtk-nav">
        <li><a href="../index.html#demos">DEMOS</a></li>
<li><a href="../doc/home.html">DOCS</a></li>
<li><a href="../apidocs/index.html">APIDOCS</a></li>

    </div>

</div>


        <div class="jtk-page-container padding-top-page " style="display:flex;">
            <div id="docs-nav" tabindex="0">
                <ul>
<li>Introduction

<ul>
<li><a href="home.html">Home</a></li>
<li><a href="basic-concepts.html">Basic Concepts</a></li>
<li><a href="basic-concepts.html#instantiating">Instantiating the Toolkit</a></li>
<li><a href="basic-concepts.html#basicloading">Loading Data</a></li>
<li><a href="basic-concepts.html#rendering">Rendering</a></li>
<li><a href="getting-started.html">Creating an app</a></li>
</ul></li>
<li>Data Model

<ul>
<li><a href="data-model.html">Overview</a></li>
<li><a href="data-model.html#format">Data Format</a></li>
<li><a href="data-model.html#node-edge-port-id">Node, Group, Edge and Port IDs</a></li>
<li><a href="data-model.html#node-edge-port-type">Node, Group, Edge and Port Type</a></li>
<li><a href="data-model.html#datafactories">Data Factories</a></li>
<li><a href="graph.html">Graph Operations</a></li>
</ul></li>
<li>Rendering

<ul>
<li><a href="rendering.html">Overview</a></li>
<li><a href="views.html">Configuring a View</a></li>
<li><a href="templating.html">Templating</a></li>
<li><a href="groups.html">Groups</a></li>
<li><a href="layouts.html">Layouts</a></li>
<li><a href="ui-states.html">UI States</a></li>
<li><a href="path-tracing.html">Path Tracing</a></li>
<li><a href="rendering.html#visibility">Hiding/Showing Elements</a></li>
<li><a href="rendering.html#dragpalette">Drag &amp; Drop Nodes</a></li>
<li><a href="navigation.html">Navigating your Dataset</a></li>
<li><a href="widget-surface.html#zooming">Zooming</a></li>
<li><a href="widget-surface.html">Surface Widget</a></li>
</ul></li>
<li>Data Management

<ul>
<li><a href="loading-and-saving-data.html">Loading &amp; Saving Data</a></li>
<li><a href="updating-data.html">Updating Data</a></li>
</ul></li>
<li>CSS

<ul>
<li><a href="css.html">Overview</a></li>
<li><a href="css.html#defaultcss">Default CSS Stylesheet</a></li>
<li><a href="css.html#ref">Class Reference</a></li>
</ul></li>
<li>Events

<ul>
<li><a href="events.html">Overview</a></li>
<li><a href="events.html#toolkit">Toolkit Events</a></li>
<li><a href="events.html#surface">Rendering Events</a></li>
</ul></li>
<li>Selecting Content

<ul>
<li><a href="selections.html">Selections</a></li>
<li><a href="selections.html#filter">Filtering</a></li>
<li><a href="paths.html">Paths</a></li>
</ul></li>
<li>Library Integrations

<ul>
<li><a href="angular-1.x-integration">Angular 1.x</a></li>
<li><a href="angular-integration.html">Angular 4/Angular 2</a></li>
<li><a href="react-integration.html">React</a> </li>
<li><a href="vue2-integration.html">Vue 2</a> </li>
</ul></li>
<li>Demonstrations<br>

<ul>
<li><a href="demo-hierarchical.html">Hierarchical Layout</a></li>
<li><a href="multiple-hierarchy.html">Hierarchy (multiple roots)</a></li>
<li><a href="demo-spring.html">Spring Layout</a></li>
<li><a href="demo-circular.html">Circular Layout</a></li>
<li><a href="demo-multiple.html">Multiple Renderers</a></li>
<li><a href="demo-paths.html">Path Tracing</a></li>
<li><a href="demo-absolute.html">Absolute Layout</a></li>
<li><a href="demo-database-visualizer.html">Database Visualizer</a></li>
<li><a href="demo-flowchart-builder.html">Flowchart Builder</a></li>
<li><a href="demo-angular-1.x">Angular 1.x Integration</a></li>
<li><a href="demo-angular.html">Angular 4 / Angular 2 Integration (Typescript)</a></li>
<li><a href="demo-react.html">React Integration</a></li>
<li><a href="demo-vue2.html">Vue 2 Integration</a></li>
<li><a href="demo-hello-world.html">Hello World</a></li>
<li><a href="demo-groups.html">Groups</a></li>
<li><a href="demo-angular-1.x-groups">Groups (Angular)</a></li>
<li><a href="demo-angular-groups.html">Groups (Angular 2)</a></li>
<li><a href="demo-active-filtering.html">Active Filtering</a></li>
<li><a href="demo-webpack.html">Webpack Bundling</a></li>
</ul></li>
<li>Miscellaneous

<ul>
<li><a href="dialogs.html">Dialogs</a></li>
<li><a href="drawing.html">Drawing</a></li>
<li><a href="changelog.html">Changelog</a></li>
</ul></li>
</ul>


            </div>
            <div id="docs">                
                <div class="markdown-body">
                    <p><a id="top"></a></p>

<h2>Flowchart Builder</h2>

<p>This is a simple flowchart builder application, with support for questions, actions and outputs.</p>

<p><img src="demo-flowchart.png" alt="Flowchart Builder Demonstration"></p>

<p>This page gives you an in-depth look at how the application is put together.</p>

<ul>
<li><a href="#setup">Page Setup</a></li>
<li><a href="#templates">Templates</a></li>
<li><a href="#loading">Data Loading</a></li>
<li><a href="#behaviour">Behaviour</a></li>
<li><a href="#resizedrag">Resizing/Dragging Nodes</a></li>
<li><a href="#selecting">Selecting Nodes</a></li>
<li><a href="#dialogs">Dialogs</a></li>
<li><a href="#dragging">Dragging New Nodes</a></li>
<li><a href="#adding-node-type">Adding a new Node type</a></li>
</ul>

<hr>

<p><a id="setup"></a></p>

<h3>Page Setup</h3>

<h6>CSS</h6>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;node_modules/font-awesome/css/font-awesome.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;node_modules/jsplumbtoolkit/dist/css/jsplumbtoolkit-defaults.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;node_modules/jsplumbtoolkit/dist/css/jsplumbtoolkit-demo.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;app.css&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<p>Font Awesome, Bootstrap, <code>jsplumbtoolkit-demo.css</code>, and <code>app.css</code> are used for this demo and are not jsPlumb Toolkit requirements. <code>jsplumbtoolkit-defaults.css</code> is recommended for 
all apps using the Toolkit, at least when you first start to build your app. This stylesheet contains sane defaults for the various widgets in the Toolkit.</p>

<h6>JS</h6>

<ul>
<li><strong>jsPlumbToolkit-x.x.x.js</strong></li>
<li><strong>app.js</strong> Application specific JS.</li>
</ul>

<hr>

<p><a id="templates"></a></p>

<h3>Templates</h3>

<p>There are four templates used by the app - one each for the node types of <code>Question</code>, <code>Action</code> and <code>Output</code>, and one 
for the <code>Start</code> node. These are contained in the <code>templates.html</code> file, which is imported into the page via this
script tag:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/x-jtk-templates&quot;</span> <span class="na">src=</span><span class="s">&quot;templates.html&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>
<p>The templates look like this:</p>

<p><strong>Start</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">id=</span><span class="s">&quot;tmplStart&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;left:${left}px;top:${top}px;width:${w}px;height:${h}px;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-start&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;svg:svg</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;svg:ellipse</span> <span class="na">cx=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">cy=</span><span class="s">&quot;${h/2}&quot;</span> <span class="na">rx=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">ry=</span><span class="s">&quot;${h/2}&quot;</span><span class="nt">&gt;&lt;/svg:ellipse&gt;</span>
        <span class="nt">&lt;svg:text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="na">x=</span><span class="s">&quot;${ w / 2 }&quot;</span> <span class="na">y=</span><span class="s">&quot;${ h / 2 }&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;</span>${text}<span class="nt">&lt;/svg:text&gt;</span>
      <span class="nt">&lt;/svg:svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-source</span> <span class="na">port-type=</span><span class="s">&quot;start&quot;</span> <span class="na">filter=</span><span class="s">&quot;svg *&quot;</span> <span class="na">filter-negate=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/jtk-source&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>The <strong>Start</strong> node consists of an ellipse with a text label centered inside of it. Note here how all SVG elements are required to be declared in the <code>svg:</code> namespace. This is a requirement of <a href="https://github.com/jsplumb/rotors">Rotors</a> and would not necessarily apply if you were using some other template engine.</p>

<p>In this template we can see the <code>w</code>, <code>h</code>, <code>left</code> and <code>top</code> values from the node&#39;s data being used not just to position the element but also to provide appropriate values for the ellipse and text label.</p>

<p>The <code>jtk-source</code> element declares that this node is an edge source, of type <code>start</code> (the <code>port-type</code> attribute specifies this).  The <code>filter</code> attribute instructs the Toolkit to enable drag only from some element that is not a child of an <code>svg</code> element, but then <code>filter-negate</code> is <code>true</code>: the result is that dragging will begin only from a descendant of the <code>svg</code> element. What this means visually is that the user will not be able to start a drag from the whitespace surrounding the ellipse.</p>

<p><strong>Action</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">id=</span><span class="s">&quot;tmplAction&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;left:${left}px;top:${top}px;width:${w}px;height:${h}px;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-action&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;svg:svg</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;svg:rect</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;&lt;/svg:rect&gt;</span>
        <span class="nt">&lt;svg:text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="na">x=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">y=</span><span class="s">&quot;${h/2}&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;</span>${text}<span class="nt">&lt;/svg:text&gt;</span>
      <span class="nt">&lt;/svg:svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
    <span class="nt">&lt;jtk-port</span> <span class="na">port-type=</span><span class="s">&quot;source&quot;</span><span class="nt">&gt;&lt;/jtk-port&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>Once again we use the position and dimensions for the node&#39;s main container as well as its SVG elements. <strong>Action</strong> nodes are configured as both edge sources and targets.</p>

<p><strong>Question</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">id=</span><span class="s">&quot;tmplQuestion&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;left:${left}px;top:${top}px;width:${w}px;height:${h}px;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-question&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;svg:svg</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;svg:path</span> <span class="na">d=</span><span class="s">&quot;M ${w/2} 0 L ${w} ${h/2} L ${w/2} ${h} L 0 ${h/2} Z&quot;</span><span class="nt">&gt;&lt;/svg:path&gt;</span>
        <span class="nt">&lt;svg:text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="na">x=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">y=</span><span class="s">&quot;${h/2}&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;</span>${text}<span class="nt">&lt;/svg:text&gt;</span>
      <span class="nt">&lt;/svg:svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-port</span> <span class="na">port-id=</span><span class="s">&quot;no&quot;</span> <span class="na">port-type=</span><span class="s">&quot;noSource&quot;</span><span class="nt">&gt;&lt;/jtk-port&gt;</span>
    <span class="nt">&lt;jtk-port</span> <span class="na">port-id=</span><span class="s">&quot;yes&quot;</span> <span class="na">port-type=</span><span class="s">&quot;yesSource&quot;</span><span class="nt">&gt;&lt;/jtk-port&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>The <strong>Question</strong> node draws a diamond, and declares itself to be an edge target. Unlike the <strong>Action</strong> node, though, this node adds two Endpoints, via <code>jtk-port</code> elements, instead of declaring that the entire element is an edge source.</p>

<p><strong>Output</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"> <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">id=</span><span class="s">&quot;tmplOutput&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;left:${left}px;top:${top}px;width:${w}px;height:${h}px;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-output&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;svg:svg</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;svg:rect</span> <span class="na">x=</span><span class="s">&quot;0&quot;</span> <span class="na">y=</span><span class="s">&quot;0&quot;</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;&lt;/svg:rect&gt;</span>
        <span class="nt">&lt;svg:text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="na">x=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">y=</span><span class="s">&quot;${h/2}&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;</span>${text}<span class="nt">&lt;/svg:text&gt;</span>
      <span class="nt">&lt;/svg:svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>The <code>Output</code> node is configured to be a connection target only.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="loading"></a></p>

<h3>Data Loading</h3>

<p>Data for this application is stored in <code>data/flowchart-1.json</code> inside the application folder. It is loaded by this code:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">toolkit</span><span class="p">.</span><span class="nx">load</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;data/flowchart-1.json&quot;</span>
<span class="p">});</span>
</code></pre></div>
<hr>

<p><a id="dragging"></a></p>

<h3>Dragging New Nodes</h3>

<p>The Surface widget provides a means for you to configure a set of nodes that you wish to be able to drag and drop into the work area. This is the code in the Flowchart Builder that does this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">renderer</span><span class="p">.</span><span class="nx">registerDroppableNodes</span><span class="p">({</span>
  <span class="nx">droppables</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#nodePalette li&quot;</span><span class="p">),</span> 
  <span class="nx">dragOptions</span><span class="o">:</span><span class="p">{</span>
    <span class="nx">zIndex</span><span class="o">:</span><span class="mi">50000</span><span class="p">,</span>
    <span class="nx">cursor</span><span class="o">:</span><span class="s2">&quot;move&quot;</span><span class="p">,</span>
    <span class="nx">clone</span> <span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nx">typeExtractor</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">return</span>  <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;jtk-node-type&quot;</span><span class="p">);</span> 
  <span class="p">},</span> 
  <span class="nx">dataGenerator</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span><span class="nx">type</span> <span class="p">};</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>So, the method is <code>registerDroppableNodes</code>. It takes four arguments:</p>

<ul>
<li><strong>droppables</strong> This is the list of elements you wish to make droppable. It doesn&#39;t matter where in your UI these elements are located; you just need to provide a suitable selector to find them all. </li>
<li><strong>dragOptions</strong> Strictly speaking this is optional, but you will almost certainly want to ensure that the underlying library&#39;s drag method will create a clone of your element when a drag starts, so you&#39;d need to provide at least that parameter. Note in this app we are using vanilla jsPlumb for drag/drop, so the required parameter is <code>clone:true</code>. If you were using jQuery as the underlying library, you would set <code>helper:&quot;clone&quot;</code> here instead.</li>
<li><strong>typeGenerator</strong> This function is used by the Toolkit to determine the <code>type</code> of a Node you have just dropped. In this case we have written the Node type into the <code>jtk-node-type</code> attribute, so we just extract it from there.</li>
<li><strong>dataGenerator</strong> This function is used by the Toolkit to generate an initial dataset for a Node you have just dropped. It is called after the <code>typeGenerator</code> function.</li>
</ul>

<hr>

<p><a id="behaviour"></a></p>

<h3>Behaviour</h3>

<p>The Toolkit publishes a long list of events during the rendering lifecycle - <code>nodeAdded</code>, <code>edgeAdded</code>, etc - all of which can be subscribed to from within a palette definition. But for your app&#39;s behaviour, it is better to use event delegation and configure all of your event listeners in one place. In the Flowchart Builder there are three pieces of behaviour that we need to code that are not completely handled for us by the Toolkit:</p>

<ul>
<li>Edit Node Text</li>
<li>Delete Node</li>
<li>Remove Edge</li>
</ul>

<p>We&#39;ll go through each of these and provide a brief code snippet highlighting the main points.</p>

<h6>Edit Node Text</h6>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="s2">&quot;tap&quot;</span><span class="p">,</span> <span class="s2">&quot;.node-edit&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">getObjectInfo</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgText&quot;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
    <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Edit &quot;</span> <span class="o">+</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; name&quot;</span><span class="p">,</span>
    <span class="nx">onOK</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// if name is at least 2 chars long, update the underlying data and update the UI.</span>
        <span class="nx">toolkit</span><span class="p">.</span><span class="nx">updateNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>Note here the <code>getObjectInfo</code> method: this is method with which you will want to acquaint yourself. It is defined on a 
Surface, not on a Toolkit instance, and takes a DOM element as argument and places it within the context of some object 
managed by the Toolkit instance that the Surface is associated with. In this case, the click event occurs on an icon. 
<code>getObjectInfo</code> traverses up the icon&#39;s ancestors until it finds an element that is associated with a Toolkit object - 
in our app, either a Table or View. When a Toolkit object is found, getObjectInfo returns an object with these values:</p>

<ul>
<li><strong>id</strong> ID of the Toolkit object</li>
<li><strong>obj</strong> The associated Toolkit object. May be a Node or a Port.</li>
<li><strong>el</strong> The DOM element for the Toolkit object</li>
<li><strong>type</strong> The type of the Toolkit object. This will be &quot;Node&quot; or &quot;Port&quot;.</li>
</ul>

<p>In this event handler, we show the user a dialog that will allow them to edit the Node&#39;s text. If the edited text is at 
least two character long we update the model.</p>

<p>This application uses the Toolkit&#39;s <a href="dialogs.html">dialogs</a> import to manage simple interactions with data members such as 
this. Your application may choose to use a different mechanism.</p>

<h6>Delete Node</h6>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="s2">&quot;tap&quot;</span><span class="p">,</span> <span class="s2">&quot;.node-delete&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">getObjectInfo</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgConfirm&quot;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;Delete &#39;&quot;</span> <span class="o">+</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
    <span class="p">},</span>
    <span class="nx">onOK</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">toolkit</span><span class="p">.</span><span class="nx">removeNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>We use <code>getObjectInfo</code> again to find the related Toolkit Node, and then we prompt the user to see if they wish to delete 
it. If the users answers yes, then we call removeNode on the Toolkit, passing in the ID of the object to delete. This 
will cause all Edges associated with the Node to be deleted, and for the UI to be updated accordingly.</p>

<h6>Remove Edge</h6>

<p>We register a <code>dblclick</code> listener on edges by providing it as an event handler to the View, on the edge type that acts 
as the parent type for all others:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">...</span>
<span class="nx">edges</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;default&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">connector</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Flowchart&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">cornerRadius</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="p">],</span>
    <span class="nx">paintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">lineWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">strokeStyle</span><span class="o">:</span> <span class="s2">&quot;#f76258&quot;</span><span class="p">,</span> <span class="nx">outlineWidth</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">outlineColor</span><span class="o">:</span> <span class="s2">&quot;transparent&quot;</span> <span class="p">},</span> 
    <span class="nx">hoverPaintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">lineWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">strokeStyle</span><span class="o">:</span> <span class="s2">&quot;rgb(67,67,67)&quot;</span> <span class="p">},</span> 
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;dblclick&quot;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
          <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgConfirm&quot;</span><span class="p">,</span>
          <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;Delete Edge&quot;</span>
          <span class="p">},</span>
          <span class="nx">onOK</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">toolkit</span><span class="p">.</span><span class="nx">removeEdge</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">});</span>
      <span class="p">}</span>
   <span class="p">},</span>

<span class="p">...</span>
</code></pre></div>
<h6>Editing Edge Label</h6>

<p>All Edges except those from a <em>Start</em> node are set to be of type <code>connection</code>, which is defined in the view as follows:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">&quot;connection&quot;</span><span class="o">:</span><span class="p">{</span>
  <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
  <span class="nx">overlays</span><span class="o">:</span><span class="p">[</span>
    <span class="p">[</span> <span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">label</span><span class="o">:</span> <span class="s2">&quot;${label}&quot;</span><span class="p">,</span>
      <span class="nx">events</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">click</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_editLabel</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}]</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>We define a <code>click</code> event handler on the Label overlay which edits the label for the Edge.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="resizedrag"></a></p>

<h3>Resizing/Dragging Nodes</h3>

<p>To resize or drag a node first you must either click on it, or use the lasso (described <a href="#selecting">below</a>) to select it.  A selected node looks like this:</p>

<p><img src="flowchart-selected-node.png" alt="Selected Node"></p>

<p>The dotted line and drag handles that are added to a selected Node are put there by the Tookit&#39;s drawing tools. It 
listens to the Toolkit&#39;s select/deselect events and decorates UI elements accordingly. These tools are discussed in detail on <a href="drawing.html">this page</a>.</p>

<p>The drawing tools are initialized with this line of code:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// configure Drawing tools.</span>
<span class="k">new</span> <span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">DrawingTools</span><span class="p">({</span><span class="nx">renderer</span><span class="o">:</span> <span class="nx">renderer</span><span class="p">});</span>
</code></pre></div>
<p>You pass them the instance of the Surface widget you&#39;re working with.</p>

<h4>Dragging</h4>

<p>Nodes can be dragged only by the square in the center of the node. This is achieved by setting a <code>filter</code> on the <code>dragOptions</code> parameter on the <code>render</code> call:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">dragOptions</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">handle</span><span class="o">:</span> <span class="s2">&quot;.jtk-draw-drag&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p><code>jtk-draw-drag</code> is the classname of the square that the drawing tools place in the center of a selected node.</p>

<h4>Resizing</h4>

<p>Resizing is handled automatically by the drawing tools.  By default, these tools will change the <code>w</code>, <code>h</code>, <code>left</code> and <code>top</code> values in a node&#39;s data, but this can be changed.</p>

<p>When a node&#39;s data is updated the drawing tools call the appropriate update method on the underlying Toolkit. Note that 
to see the changes reflected immediately in the DOM you need to be using the Toolkit&#39;s default template mechanism, 
<a href="https://github.com/jsplumb/rotors">Rotors</a>. If you&#39;re using your own template mechanism you will need to listen for 
events from the drawing tools and update the DOM yourself.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="selecting"></a></p>

<h3>Selecting Nodes</h3>

<h5>Left Click</h5>

<p>Nodes can be selected with a left-click (or tap on a touch device; <code>tap</code> is a better event to choose in general because the
Toolkit abstracts out the difference between mouse devices and touch devices and presents <code>click</code> events as <code>tap</code> events
on non touch devices).  This is configured in the <code>view</code> parameter to the <code>render</code> call. In this application, 
Nodes of type <em>selectable</em> have the capability enabled with this code:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">&quot;selectable&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">tap</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">toolkit</span><span class="p">.</span><span class="nx">toggleSelection</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">node</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>tap</code> event (discussed <a href="widget-surface.html#eventlist">here</a>) is preferable to <code>click</code>, as it ensures the application responds only to true clicks on devices with a mouse, and also avoids the delay that some vendors introduce to a click event on touch devices.</p>

<h5>Lasso Selection</h5>

<p>Lasso selection is enabled by default on the Surface widget. </p>

<p>To activate the lasso, click the pencil icon in the toolbar:</p>

<p><img src="select-lasso.png" alt="Lasso Select Mode"></p>

<p>The code that listens to clicks on this icon is as follows:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// listener for mode change on renderer.</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;modeChanged&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">getSelector</span><span class="p">(</span><span class="s2">&quot;[mode]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
  <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">getSelector</span><span class="p">(</span><span class="s2">&quot;[mode=&#39;&quot;</span> <span class="o">+</span> <span class="nx">mode</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// pan mode/select mode</span>
<span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;.controls&quot;</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="s2">&quot;[mode]&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">renderer</span><span class="p">.</span><span class="nx">setMode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div>
<p>Here we&#39;ve registered an event listener to be informed when the Surface&#39;s mode has changed; it is responsible for setting the appropriate classes on the toolbar items.  The click listener extracts the desired mode from the button that was clicked and sets it on the renderer.</p>

<h5>Lasso Operation</h5>

<p>The lasso works in two ways: when you drag from left to right, any node that intersects your lasso will be selected.  When you drag from right to left, only nodes that are enclosed by your lasso will be selected.</p>

<p><img src="lasso-select-operation.png" alt="Lasso Operation"></p>

<p>Note that in this demo we also set <code>lassoInvert:true</code> on our <code>render</code> call, which results in a lasso that masks unselected
parts of the UI (which is in contrast to the default mode of operation, in which the lasso draws an element corresponding
to selected parts of the UI).</p>

<h5>Exiting Select Mode</h5>

<p>The Surface widget automatically exits select mode once the user has selected something. In this application we also listen to clicks on the whitespace in the widget and switch back to pan mode when we detect one. This is the <code>events</code> argument to the <code>render</code> call:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">canvasClick</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">toolkit</span><span class="p">.</span><span class="nx">clearSelection</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>clearSelection</code> clears the current selection and switches back to Pan mode.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="dialogs"></a></p>

<h3>Dialogs</h3>

<p>The dialogs used in this app are part of the jsPlumb Toolkit core. They provide a simple abstraction around the business of getting input from the user and dealing with it; they&#39;re not necessarily fully-featured enough for all applications.</p>

<h4>Initialization</h4>

<p>To initialize the dialogs, first call <code>jsPlumbToolkit.Dialogs.initialize</code>, with an appropriate selector for the templates for your dialogs (see below for an explanation of this):</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">initialize</span><span class="p">({</span>
  <span class="nx">selector</span><span class="o">:</span><span class="s2">&quot;.dlg&quot;</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">showDialog</span> <span class="o">=</span> <span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">;</span>
</code></pre></div>
<p>Note here we&#39;ve also aliased <code>jsPlumbToolkit.Dialogs.show</code>, to save some typing.</p>

<h4>Templates</h4>

<p>Each dialog has a template in the HTML, with some class name that you matched in the <code>selector</code> argument to the <code>initialize</code> call above:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">class=</span><span class="s">&quot;dlg&quot;</span> <span class="na">id=</span><span class="s">&quot;dlgViewQuery&quot;</span> <span class="na">title=</span><span class="s">&quot;Edit Query&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">&quot;txtViewQuery&quot;</span> <span class="err">jtk-focus</span> <span class="na">jtk-att=</span><span class="s">&quot;query&quot;</span><span class="nt">&gt;</span>${query}<span class="nt">&lt;/textarea&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<h5>Binding Parameters</h5>

<p>These templates use the same template engine as the Surface renderer, so in this example you can see we&#39;ve extracted <code>query</code> from the View node&#39;s data, and injected it into the textarea. But what might not be immediately obvious is the purpose of the <code>jtk-att</code> attribute: it tells the dialog handler that the value of this textarea should be passed to the OK handler, using the key <code>query</code>.</p>

<p>Note also in the above example, the <code>jtk-focus</code> attribute: this tells the dialog handler that the textarea should be given the focus when the dialog first opens.</p>

<h4>Showing a dialog</h4>

<p>This example is the dialog that is shown when you edit a View query. We provide the id of the template to use for the dialog, and we provide the View node&#39;s data as the backing data for the dialog. Then we provide an <code>onOK</code> callback:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">jsPlumbToolkit</span><span class="p">.</span><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
  <span class="nx">id</span><span class="o">:</span><span class="s2">&quot;dlgViewQuery&quot;</span><span class="p">,</span>
  <span class="nx">data</span><span class="o">:</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
  <span class="nx">onOK</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// update data</span>
    <span class="nx">toolkit</span><span class="p">.</span><span class="nx">updateNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="c1">// update UI                    </span>
    <span class="nx">info</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.view-details&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>The <code>data</code> argument to the <code>onOK</code> callback consists of an object whose key value pairs are determined by the <code>jtk-att</code> attributes found in the template. Recall that above we had a textarea with <code>jtk-att:&quot;query&quot;</code>. This means that the <code>data</code> argument to <code>onOK</code> looks like this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="nx">query</span><span class="o">:</span><span class="s2">&quot;the contents of the text area&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h5>Supported Input Types</h5>

<p>The list of supported input types is:</p>

<ul>
<li>text</li>
<li>radio button(s) </li>
<li>checkbox</li>
<li>select</li>
<li>textarea</li>
</ul>

<h5>Dialog Titles</h5>

<p>If you set a <code>title</code> attribute on a dialog&#39;s template, that value will be used for the title of the dialog. Alternatively, you can provide a <code>title</code> parameter to the <code>show</code> call.</p>

<h5>Lifecycle Callbacks</h5>

<p>There are three lifecycle callbacks supported:</p>

<ul>
<li><strong>onOpen</strong> Called when the dialog has been opened. The related DOM element for the dialog is passed to this method.</li>
<li><strong>onOK</strong> Called when the user presses OK. The callback is provided a data object as discussed above.</li>
<li><strong>onCancel</strong> Called when the user presses cancel. No arguments are provided to the callback.</li>
</ul>

<p><a href="#top">TOP</a></p>

<hr>

<p><a name="adding-node-type"></a></p>

<h3>Adding a new Node type</h3>

<p>If you&#39;re using this demo as a starting point for your own app, perhaps you are wondering how you&#39;d go about adding a new
type of Node.  The process is straightforward. Let&#39;s add support for Nodes with type <code>uncertainty</code>. </p>

<h4>1. Create Node template</h4>

<p>Our new Node type will be rendered as a triangle. In this demo the general form of each template is of a container
div that contains an SVG element, with the node&#39;s shape being drawn via SVG. So our <code>uncertainty</code> Node is almost
identical to a <code>question</code> node, with the only differences being the SVG <code>path</code> elements (and a CSS class):</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">id=</span><span class="s">&quot;tmplUncertainty&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;left:${left}px;top:${top}px;width:${w}px;height:${h}px;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-uncertainty&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;svg:svg</span> <span class="na">width=</span><span class="s">&quot;${w}&quot;</span> <span class="na">height=</span><span class="s">&quot;${h}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;svg:path</span> <span class="na">d=</span><span class="s">&quot;M ${w/2} 0 L ${w} ${h} L 0 ${h} L ${w/2} 0 Z&quot;</span> <span class="na">class=</span><span class="s">&quot;outer&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;svg:path</span> <span class="na">d=</span><span class="s">&quot;M ${w/2} 10 L ${w-10} ${h-5} L ${10} ${h-5} L ${w/2} 10 Z&quot;</span> <span class="na">class=</span><span class="s">&quot;inner&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;svg:text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="na">x=</span><span class="s">&quot;${w/2}&quot;</span> <span class="na">y=</span><span class="s">&quot;${h/2}&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;</span>${text}<span class="nt">&lt;/svg:text&gt;</span>
            <span class="nt">&lt;/svg:svg&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;jtk-source</span> <span class="na">port-type=</span><span class="s">&quot;source&quot;</span> <span class="na">filter=</span><span class="s">&quot;.outer&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<h4>2. Map the new type in your View</h4>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">nodes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;start&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;tmplStart&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;selectable&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">tap</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">toolkit</span><span class="p">.</span><span class="nx">toggleSelection</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;question&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">parent</span><span class="o">:</span> <span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;tmplQuestion&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;action&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">parent</span><span class="o">:</span> <span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;tmplAction&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;output&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;tmplOutput&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;uncertainty&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
        <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;tmplUncertainty&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Note here we said that this new node type&#39;s template should extend <code>selectable</code>, which <code>action</code> and <code>question</code>
and <code>output</code> all do, but <code>start</code> does not. We didn&#39;t have to extend <code>selectable</code> if we didn&#39;t want to, but it gives
us the tap to select functionality for this new type.</p>

<h5>Changes to the data</h5>

<p>For reference, here&#39;s how you&#39;d represent a Node of this new type in your data (we&#39;ve changed the existing <code>Make
Decision</code> Node here to be of our new type):</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;decide&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;uncertainty&quot;</span><span class="p">,</span>
    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;New Type&quot;</span><span class="p">,</span>
    <span class="s2">&quot;left&quot;</span><span class="o">:</span> <span class="mi">660</span><span class="p">,</span>
    <span class="s2">&quot;top&quot;</span><span class="o">:</span> <span class="mi">187</span><span class="p">,</span>
    <span class="s2">&quot;w&quot;</span><span class="o">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s2">&quot;h&quot;</span><span class="o">:</span> <span class="mi">120</span>
<span class="p">}</span>
</code></pre></div>
<p>With these few changes you get this output:</p>

<p><img src="flowchart-new-node-type.png" alt="Flowchart Builder New Node Type"></p>

                </div>
            </div>
        </div>

    </body>

</html>
