<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>jsPlumb Toolkit - documentation</title>
        <link href="../../css/main.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="../css/main.css" rel="stylesheet">



        <link rel="stylesheet" href="../css/jsplumbtoolkit-defaults.css">
        <link rel="stylesheet" href="../css/jsplumbtoolkit-demo.css">
        <link rel="stylesheet" href="../css/jsplumb-doc.css">
    </head>

    <body>

        <div class="jtk-header">
    <a class="jtk-logo" href="../index.html"><img src="../img/logo-medium-jsplumb.png"></a>

    <div class="jtk-nav">
        <li><a href="../index.html#demos">DEMOS</a></li>
<li><a href="../doc/home.html">DOCS</a></li>
<li><a href="../apidocs/index.html">APIDOCS</a></li>

    </div>

</div>


        <div class="jtk-page-container padding-top-page " style="display:flex;">
            <div id="docs-nav" tabindex="0">
                <ul>
<li>Introduction

<ul>
<li><a href="home.html">Home</a></li>
<li><a href="basic-concepts.html">Basic Concepts</a></li>
<li><a href="basic-concepts.html#instantiating">Instantiating the Toolkit</a></li>
<li><a href="basic-concepts.html#basicloading">Loading Data</a></li>
<li><a href="basic-concepts.html#rendering">Rendering</a></li>
<li><a href="getting-started.html">Creating an app</a></li>
</ul></li>
<li>Data Model

<ul>
<li><a href="data-model.html">Overview</a></li>
<li><a href="data-model.html#format">Data Format</a></li>
<li><a href="data-model.html#node-edge-port-id">Node, Group, Edge and Port IDs</a></li>
<li><a href="data-model.html#node-edge-port-type">Node, Group, Edge and Port Type</a></li>
<li><a href="data-model.html#datafactories">Data Factories</a></li>
<li><a href="graph.html">Graph Operations</a></li>
</ul></li>
<li>Rendering

<ul>
<li><a href="rendering.html">Overview</a></li>
<li><a href="views.html">Configuring a View</a></li>
<li><a href="templating.html">Templating</a></li>
<li><a href="groups.html">Groups</a></li>
<li><a href="layouts.html">Layouts</a></li>
<li><a href="ui-states.html">UI States</a></li>
<li><a href="path-tracing.html">Path Tracing</a></li>
<li><a href="rendering.html#visibility">Hiding/Showing Elements</a></li>
<li><a href="rendering.html#dragpalette">Drag &amp; Drop Nodes</a></li>
<li><a href="navigation.html">Navigating your Dataset</a></li>
<li><a href="widget-surface.html#zooming">Zooming</a></li>
<li><a href="widget-surface.html">Surface Widget</a></li>
</ul></li>
<li>Data Management

<ul>
<li><a href="loading-and-saving-data.html">Loading &amp; Saving Data</a></li>
<li><a href="updating-data.html">Updating Data</a></li>
</ul></li>
<li>CSS

<ul>
<li><a href="css.html">Overview</a></li>
<li><a href="css.html#defaultcss">Default CSS Stylesheet</a></li>
<li><a href="css.html#ref">Class Reference</a></li>
</ul></li>
<li>Events

<ul>
<li><a href="events.html">Overview</a></li>
<li><a href="events.html#toolkit">Toolkit Events</a></li>
<li><a href="events.html#surface">Rendering Events</a></li>
</ul></li>
<li>Selecting Content

<ul>
<li><a href="selections.html">Selections</a></li>
<li><a href="selections.html#filter">Filtering</a></li>
<li><a href="paths.html">Paths</a></li>
</ul></li>
<li>Library Integrations

<ul>
<li><a href="angular-1.x-integration">Angular 1.x</a></li>
<li><a href="angular-integration.html">Angular 4/Angular 2</a></li>
<li><a href="react-integration.html">React</a> </li>
<li><a href="vue2-integration.html">Vue 2</a> </li>
</ul></li>
<li>Demonstrations<br>

<ul>
<li><a href="demo-hierarchical.html">Hierarchical Layout</a></li>
<li><a href="multiple-hierarchy.html">Hierarchy (multiple roots)</a></li>
<li><a href="demo-spring.html">Spring Layout</a></li>
<li><a href="demo-circular.html">Circular Layout</a></li>
<li><a href="demo-multiple.html">Multiple Renderers</a></li>
<li><a href="demo-paths.html">Path Tracing</a></li>
<li><a href="demo-absolute.html">Absolute Layout</a></li>
<li><a href="demo-database-visualizer.html">Database Visualizer</a></li>
<li><a href="demo-flowchart-builder.html">Flowchart Builder</a></li>
<li><a href="demo-angular-1.x">Angular 1.x Integration</a></li>
<li><a href="demo-angular.html">Angular 4 / Angular 2 Integration (Typescript)</a></li>
<li><a href="demo-react.html">React Integration</a></li>
<li><a href="demo-vue2.html">Vue 2 Integration</a></li>
<li><a href="demo-hello-world.html">Hello World</a></li>
<li><a href="demo-groups.html">Groups</a></li>
<li><a href="demo-angular-1.x-groups">Groups (Angular)</a></li>
<li><a href="demo-angular-groups.html">Groups (Angular 2)</a></li>
<li><a href="demo-active-filtering.html">Active Filtering</a></li>
<li><a href="demo-webpack.html">Webpack Bundling</a></li>
</ul></li>
<li>Miscellaneous

<ul>
<li><a href="dialogs.html">Dialogs</a></li>
<li><a href="drawing.html">Drawing</a></li>
<li><a href="changelog.html">Changelog</a></li>
</ul></li>
</ul>


            </div>
            <div id="docs">                
                <div class="markdown-body">
                    <p><a name="top"></a></p>

<h2>Flowchart Builder (Angular 4 Typescript)</h2>

<p>This is a port of the Flowchart Builder application that demonstrates the Toolkit&#39;s Angular 4 Typescript integration. Note that this particular
demonstration is written with SystemJS, but there is an exact copy available in <code>angular-cli</code>; the differences between that demo and this
 are detailed <a href="demo-angular-cli.html">here</a>.</p>

<p>There are also Angular 2 versions of this demo (and its CLI counterpart) available in <code>angular2</code> and <code>angular2-cli</code> respectively. </p>

<p><img src="demo-flowchart.png" alt="Flowchart Builder Demonstration"></p>

<p>This page gives you an in-depth look at how the application is put together.</p>

<ul>
<li><a href="#package">package.json</a></li>
<li><a href="#setup">Page Setup</a></li>
<li><a href="#typescript-setup">Typescript Setup</a></li>
<li><a href="#systemjs-setup">SystemJS Setup</a></li>
<li><a href="#templates">Templates</a></li>
<li><a href="#bootstrap">Bootstrap</a></li>
<li><a href="#toolkitParams">Toolkit Parameters</a></li>
<li><a href="#renderParams">Render Parameters</a></li>
<li><a href="#view">View</a></li>
<li><a href="#initialisation">Initialisation</a></li>
<li><a href="#loading">Data Loading</a></li>
<li><a href="#behaviour">Behaviour</a></li>
<li><a href="#resizedrag">Resizing/Dragging Nodes</a></li>
<li><a href="#selecting">Selecting Nodes</a></li>
<li><a href="#dialogs">Dialogs</a></li>
<li><a href="#dragging">Dragging New Nodes</a></li>
</ul>

<p>jsPlumb&#39;s Angular 2 integration and demonstrations are based on the <a href="https://angular.io/docs/ts/latest/quickstart.html">Angular 2 Quickstart Guide</a>.</p>

<p><a id="package"></a></p>

<h3>package.json</h3>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;tscr&quot;</span><span class="o">:</span><span class="s2">&quot;tsc -traceResolution&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tsc&quot;</span><span class="o">:</span><span class="s2">&quot;tsc&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;dependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;@angular/common&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/compiler&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/core&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/forms&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/http&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/platform-browser&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/platform-browser-dynamic&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/router&quot;</span><span class="o">:</span> <span class="s2">&quot;~3.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;@angular/upgrade&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;systemjs&quot;</span><span class="o">:</span> <span class="s2">&quot;0.19.40&quot;</span><span class="p">,</span>
        <span class="s2">&quot;core-js&quot;</span><span class="o">:</span> <span class="s2">&quot;^2.4.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reflect-metadata&quot;</span><span class="o">:</span> <span class="s2">&quot;^0.1.8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rxjs&quot;</span><span class="o">:</span> <span class="s2">&quot;~5.0.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zone.js&quot;</span><span class="o">:</span> <span class="s2">&quot;^0.7.4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jsplumbtoolkit&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../jsplumbtoolkit.tgz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jsplumbtoolkittypes&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../types/jsplumbtoolkit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jsplumbtypes&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../types/jsplumb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;font-awesome&quot;</span><span class="o">:</span> <span class="s2">&quot;^4.7.0&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;devDependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;concurrently&quot;</span><span class="o">:</span> <span class="s2">&quot;^3.0.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;typescript&quot;</span><span class="o">:</span> <span class="s2">&quot;~2.0.10&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>As with the <code>systemjs-config.js</code> file discussed below, this was taken directly from the <a href="https://angular.io/docs/ts/latest/quickstart.html">Angular 2 Quickstart Guide</a>.</p>

<p>There are three entries specific to jsPlumb:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">&quot;jsplumbtoolkit&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../jsplumbtoolkit.tgz&quot;</span><span class="p">,</span>
<span class="s2">&quot;jsplumbtoolkittypes&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../types/jsplumbtoolkit&quot;</span><span class="p">,</span>
<span class="s2">&quot;jsplumbtypes&quot;</span><span class="o">:</span><span class="s2">&quot;file:../../types/jsplumb&quot;</span>
</code></pre></div>
<p>The first of these is the jsPlumb Toolkit code. The other two entries link to the Typescript Definition files, which are discussed 
<a href="angular2-integration.html#typescript-definitions">here</a>.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="setup"></a></p>

<h3>Page Setup</h3>

<h6>CSS</h6>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;node_modules/font-awesome/css/font-awesome.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;node_modules/jsplumbtoolkit/dist/css/jsplumbtoolkit-defaults.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;node_modules/jsplumbtoolkit/dist/css/jsplumbtoolkit-demo.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;app.css&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<p>Font Awesome, Bootstrap, <code>jsplumbtoolkit-demo.css</code>, and <code>app.css</code> are used for this demo and are not jsPlumb Toolkit requirements. <code>jsplumbtoolkit-defaults.css</code> is recommended for 
all apps using the Toolkit, at least when you first start to build your app. This stylesheet contains sane defaults for the various widgets in the Toolkit.</p>

<h6>JS</h6>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;node_modules/core-js/client/shim.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;node_modules/zone.js/dist/zone.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;node_modules/systemjs/dist/system.src.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;systemjs.config.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    System.import(&#39;app&#39;).catch(function(err){ console.error(err); });
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>We use SystemJS as the loader for this application; this is fairly common with Angular 2 apps. The actual source files, which are Typescript files in the <code>src</code> directory, are:</p>

<ul>
<li><strong>src/main.ts</strong>  Launcher</li>
<li><strong>src/app.module.ts</strong> Application module definition</li>
<li><strong>src/app.component.js</strong> Main demo component and business logic.</li>
</ul>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="typescript-setup"></a></p>

<h3>Typescript Setup</h3>

<p>This is the <code>tsconfig.json</code> file used by this demonstration:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="s2">&quot;compilerOptions&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;target&quot;</span><span class="o">:</span> <span class="s2">&quot;es5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;module&quot;</span><span class="o">:</span> <span class="s2">&quot;commonjs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;moduleResolution&quot;</span><span class="o">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sourceMap&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;emitDecoratorMetadata&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;experimentalDecorators&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;lib&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;es2015&quot;</span><span class="p">,</span> <span class="s2">&quot;dom&quot;</span> <span class="p">],</span>
    <span class="s2">&quot;noImplicitAny&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;suppressImplicitAnyIndexErrors&quot;</span><span class="o">:</span> <span class="kc">true</span>

  <span class="p">},</span>
  <span class="s2">&quot;include&quot;</span><span class="o">:</span><span class="p">[</span> <span class="s2">&quot;src/**/*&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>The two things to note here are that we use <code>commonjs</code> as the <code>module</code> type, and we have <code>moduleResolution</code> set to <code>node</code>. Both of these settings are required by jsPlumb.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="systemjs-setup"></a></p>

<h3>SystemJS Setup</h3>

<p><em>Note</em> for a discussion of Angular CLI, see <a href="demo-angular-cli.html">here</a>.</p>

<p>This is the config file for SystemJS we use in this demonstration. This is taken directly from the <a href="https://angular.io/docs/ts/latest/quickstart.html">Angular 2 Quickstart Guide</a>, with the addition of entries for 
the Community and Toolkit editions of jsPlumb:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**</span>
<span class="cm"> * System configuration for Angular samples</span>
<span class="cm"> * Adjust as necessary for your application needs.</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">global</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">System</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
      <span class="c1">// paths serve as alias</span>
      <span class="s1">&#39;npm:&#39;</span><span class="o">:</span> <span class="s1">&#39;node_modules/&#39;</span>
    <span class="p">},</span>
    <span class="c1">// map tells the System loader where to look for things</span>
    <span class="nx">map</span><span class="o">:</span> <span class="p">{</span>
      <span class="c1">// our app is within the app folder</span>
      <span class="nx">app</span><span class="o">:</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span>

      <span class="c1">// angular bundles</span>
      <span class="s1">&#39;@angular/core&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/core/bundles/core.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/common&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/common/bundles/common.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/compiler&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/compiler/bundles/compiler.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/platform-browser&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/platform-browser/bundles/platform-browser.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/platform-browser-dynamic&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/http&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/http/bundles/http.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/router&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/router/bundles/router.umd.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;@angular/forms&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:@angular/forms/bundles/forms.umd.js&#39;</span><span class="p">,</span>

      <span class="s1">&#39;jsplumbtoolkit&#39;</span><span class="o">:</span><span class="s2">&quot;npm:jsplumbtoolkit/dist/js/jsplumbtoolkit.js&quot;</span><span class="p">,</span>

      <span class="c1">// other libraries</span>
      <span class="s1">&#39;rxjs&#39;</span><span class="o">:</span>                      <span class="s1">&#39;npm:rxjs&#39;</span><span class="p">,</span>
      <span class="s1">&#39;angular-in-memory-web-api&#39;</span><span class="o">:</span> <span class="s1">&#39;npm:angular-in-memory-web-api/bundles/in-memory-web-api.umd.js&#39;</span>
    <span class="p">},</span>
    <span class="c1">// packages tells the System loader how to load when no filename and/or no extension</span>
    <span class="nx">packages</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">app</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">main</span><span class="o">:</span> <span class="s1">&#39;./main.js&#39;</span><span class="p">,</span>
        <span class="nx">defaultExtension</span><span class="o">:</span> <span class="s1">&#39;js&#39;</span>
      <span class="p">},</span>
      <span class="nx">rxjs</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">defaultExtension</span><span class="o">:</span> <span class="s1">&#39;js&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="k">this</span><span class="p">);</span>
</code></pre></div>
<p>The jsPlumb Toolkit is referenced in <code>package.json</code> as a local file.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="templates"></a></p>

<h3>Templates</h3>

<p>There are four templates used by the app - one each for the node types of <code>Question</code>, <code>Action</code> and <code>Output</code>, and one 
for the <code>Start</code> node. These are stored as html files in the <code>templates</code> directory.</p>

<p>The templates look like this:</p>

<p><strong>Start</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="err">[style.width]=&quot;obj.w</span> <span class="err">+</span> <span class="err">&#39;px&#39;&quot;</span> <span class="err">[style.height]=&quot;obj.h</span> <span class="err">+&#39;px&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-start&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;position:relative&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;svg</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;ellipse</span> <span class="err">[attr.cx]=&quot;obj.w/2&quot;</span> <span class="err">[attr.cy]=&quot;obj.h/2&quot;</span> <span class="err">[attr.rx]=&quot;obj.w/2&quot;</span> <span class="err">[attr.ry]=&quot;obj.h/2&quot;</span> <span class="na">class=</span><span class="s">&quot;outer&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;ellipse</span> <span class="err">[attr.cx]=&quot;obj.w/2&quot;</span> <span class="err">[attr.cy]=&quot;obj.h/2&quot;</span> <span class="err">[attr.rx]=&quot;(obj.w/2)</span> <span class="err">-</span> <span class="err">10&quot;</span> <span class="err">[attr.ry]=&quot;(obj.h/2)</span> <span class="err">-</span> <span class="err">10&quot;</span> <span class="na">class=</span><span class="s">&quot;inner&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="err">[attr.x]=&quot;obj.w</span> <span class="err">/</span> <span class="err">2&quot;</span> <span class="err">[attr.y]=&quot;obj.h</span> <span class="err">/</span> <span class="err">2&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;&lt;/text&gt;</span>
        <span class="nt">&lt;/svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-source</span> <span class="na">port-type=</span><span class="s">&quot;start&quot;</span> <span class="na">filter=</span><span class="s">&quot;.outer&quot;</span> <span class="na">filter-negate=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/jtk-source&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The <strong>Start</strong> node consists of an ellipse with a text label centered inside of it. Note that all references to the node data that is being rendered are prefixed 
with <code>obj.</code>. For instance, the first line in the template here is:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="err">[style.width]=&quot;obj.w</span> <span class="err">+</span> <span class="err">&#39;px&#39;&quot;</span> <span class="err">[style.height]=&quot;obj.h</span> <span class="err">+&#39;px&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-start&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<p>but in the version of this demo using the default templating mechanism it looks like this:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;width:${w}px;height:${h}px;&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<ul>
<li>As with the default templating mechanism (and in contrast to the Toolkit&#39;s Angular 1.x integration), we expect one
root element per template. </li>
</ul>

<p>The <code>jtk-source</code> element declares that this node is an edge source, of type <code>start</code> (the <code>port-type</code> attribute 
specifies this).  The <code>filter</code> attribute instructs the Toolkit to enable drag only from some element that is not a 
child of an <code>svg</code> element, but then <code>filter-negate</code> is <code>true</code>: the result is that dragging will begin only from a 
descendant of the <code>svg</code> element. What this means visually is that the user will not be able to start a drag from the 
whitespace surrounding the ellipse.</p>

<p><strong>Action</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="err">[style.width]=&quot;obj.w</span> <span class="err">+</span> <span class="err">&#39;px&#39;&quot;</span> <span class="err">[style.height]=&quot;obj.h</span> <span class="err">+&#39;px&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-action&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span> <span class="err">(click)=&quot;editNode(obj)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span> <span class="err">(click)=&quot;removeNode(obj)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;svg</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;rect</span> <span class="err">[attr.x]=&quot;0&quot;</span> <span class="err">[attr.y]=&quot;0&quot;</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span> <span class="na">class=</span><span class="s">&quot;outer&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;rect</span> <span class="err">[attr.x]=&quot;10&quot;</span> <span class="err">[attr.y]=&quot;10&quot;</span> <span class="err">[attr.width]=&quot;obj.w-20&quot;</span> <span class="err">[attr.height]=&quot;obj.h-20&quot;</span> <span class="na">class=</span><span class="s">&quot;inner&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="err">[attr.x]=&quot;obj.w/2&quot;</span> <span class="err">[attr.y]=&quot;obj.h/2&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;&lt;/text&gt;</span>
        <span class="nt">&lt;/svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
    <span class="nt">&lt;jtk-source</span> <span class="na">port-type=</span><span class="s">&quot;source&quot;</span> <span class="na">filter=</span><span class="s">&quot;.outer&quot;</span><span class="nt">&gt;&lt;/jtk-source&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Once again we use the position and dimensions for the node&#39;s main container as well as its SVG elements. <code>Action</code> nodes are 
configured as both edge sources and targets.</p>

<p><strong>Question</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="err">[style.width]=&quot;obj.w</span> <span class="err">+</span> <span class="err">&#39;px&#39;&quot;</span> <span class="err">[style.height]=&quot;obj.h</span> <span class="err">+&#39;px&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-question&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span> <span class="err">(click)=&quot;editNode(obj)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span> <span class="err">(click)=&quot;removeNode(obj)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;svg</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="err">[attr.d]=&quot;&#39;M</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.w/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">0</span> <span class="err">L</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.w</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.h/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">L</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.w/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.h</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">L</span> <span class="err">0</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.h/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">Z&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;outer&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;path</span> <span class="err">[attr.d]=&quot;&#39;M</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.w/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">10</span> <span class="err">L</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">(obj.w-10)</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.h/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">L</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.w/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">(obj.h-10)</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">L</span> <span class="err">10</span> <span class="err">&#39;</span> <span class="err">+</span> <span class="err">obj.h/2</span> <span class="err">+</span> <span class="err">&#39;</span> <span class="err">Z&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;inner&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="err">[attr.x]=&quot;obj.w/2&quot;</span> <span class="err">[attr.y]=&quot;obj.h/2&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;&lt;/text&gt;</span>
        <span class="nt">&lt;/svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-source</span> <span class="na">port-type=</span><span class="s">&quot;source&quot;</span> <span class="na">filter=</span><span class="s">&quot;.outer&quot;</span><span class="nt">&gt;&lt;/jtk-source&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The <code>Question</code> node draws a diamond, and declares itself to be an edge target and source.  Note the format of the <code>attr.d</code> attributes on the <code>path</code> elements: in Angular 2, 
the &quot;square bracket&quot; syntax expects the right hand side to contain a valid Javascript expression.</p>

<p><strong>Output</strong></p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"> <span class="nt">&lt;div</span> <span class="err">[style.width]=&quot;obj.w</span> <span class="err">+</span> <span class="err">&#39;px&#39;&quot;</span> <span class="err">[style.height]=&quot;obj.h</span> <span class="err">+&#39;px&#39;&quot;</span> <span class="na">class=</span><span class="s">&quot;flowchart-object flowchart-output&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span> <span class="err">(click)=&quot;editNode()&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> 
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span> <span class="err">(click)=&quot;deleteNode()&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;svg</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;rect</span> <span class="err">[attr.x]=&quot;0&quot;</span> <span class="err">[attr.y]=&quot;0&quot;</span> <span class="err">[attr.width]=&quot;obj.w&quot;</span> <span class="err">[attr.height]=&quot;obj.h&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;text</span> <span class="na">text-anchor=</span><span class="s">&quot;middle&quot;</span> <span class="err">[attr.x]=&quot;obj.w/2&quot;</span> <span class="err">[attr.y]=&quot;obj.h/2&quot;</span> <span class="na">dominant-baseline=</span><span class="s">&quot;central&quot;</span><span class="nt">&gt;&lt;/text&gt;</span>
        <span class="nt">&lt;/svg&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;jtk-target</span> <span class="na">port-type=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/jtk-target&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The <code>Output</code> node is configured to be a connection target only.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a name="bootstrap"></a></p>

<h3>Bootstrap</h3>

<p>We use SystemJS to bootstrap the application:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;systemjs.config.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    System.import(&#39;app&#39;).catch(function(err){ console.error(err); });
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>Here, <code>app</code> is a module defined in <code>src/app.module.ts</code>:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">NgModule</span><span class="p">,</span> <span class="nx">CUSTOM_ELEMENTS_SCHEMA</span> <span class="p">}</span>      <span class="nx">from</span> <span class="s1">&#39;@angular/core&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">BrowserModule</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@angular/platform-browser&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">AppComponent</span><span class="p">,</span> <span class="nx">QuestionNodeComponent</span><span class="p">,</span> <span class="nx">ActionNodeComponent</span><span class="p">,</span> <span class="nx">StartNodeComponent</span><span class="p">,</span> <span class="nx">OutputNodeComponent</span> <span class="p">}</span>  <span class="nx">from</span> <span class="s1">&#39;./app.component&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">jsPlumbToolkitModule</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;./jsplumbtoolkit-angular2&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Dialogs</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;jsplumbtoolkit&quot;</span>

<span class="err">@</span><span class="nx">NgModule</span><span class="p">({</span>
    <span class="nx">imports</span><span class="o">:</span>      <span class="p">[</span> <span class="nx">BrowserModule</span><span class="p">,</span> <span class="nx">jsPlumbToolkitModule</span> <span class="p">],</span>
    <span class="nx">declarations</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AppComponent</span><span class="p">,</span> <span class="nx">QuestionNodeComponent</span><span class="p">,</span> <span class="nx">ActionNodeComponent</span><span class="p">,</span> <span class="nx">StartNodeComponent</span><span class="p">,</span> <span class="nx">OutputNodeComponent</span> <span class="p">],</span>
    <span class="nx">bootstrap</span><span class="o">:</span>    <span class="p">[</span> <span class="nx">AppComponent</span> <span class="p">],</span>
    <span class="nx">entryComponents</span><span class="o">:</span> <span class="p">[</span> <span class="nx">QuestionNodeComponent</span><span class="p">,</span> <span class="nx">ActionNodeComponent</span><span class="p">,</span> <span class="nx">StartNodeComponent</span><span class="p">,</span> <span class="nx">OutputNodeComponent</span> <span class="p">],</span>
    <span class="nx">schemas</span><span class="o">:</span><span class="p">[</span> <span class="nx">CUSTOM_ELEMENTS_SCHEMA</span> <span class="p">]</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{</span> 
    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// initialize dialogs</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">initialize</span><span class="p">({</span>
            <span class="nx">selector</span><span class="o">:</span> <span class="s2">&quot;.dlg&quot;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><a id="components"></a></p>

<h3>Components</h3>

<p>The demo is written as a root level component, which itself uses components from the jsPlumb Angular 2 module. In the HTML file, the
demo component is declared with a single element:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;jsplumb-demo&gt;</span>Loading Flowchart Builder...<span class="nt">&lt;/jsplumb-demo&gt;</span>
</code></pre></div>
<p>The <code>jsplumb-demo</code> component is created inside the file <code>src/app.component.ts</code>. Its template looks like this:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;sidebar node-palette&quot;</span> <span class="err">jsplumb-palette</span> <span class="na">selector=</span><span class="s">&quot;li&quot;</span> <span class="na">surfaceId=</span><span class="s">&quot;flowchartSurface&quot;</span> <span class="err">[typeExtractor]=&quot;typeExtractor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        <span class="nt">&lt;li</span> <span class="err">*</span><span class="na">ngFor=</span><span class="s">&quot;let nodeType of nodeTypes&quot;</span> <span class="err">[attr.jtk-node-type]=&quot;nodeType.type&quot;</span> <span class="na">title=</span><span class="s">&quot;Drag to add new&quot;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;jsplumb-toolkit</span> <span class="err">#toolkit</span> <span class="na">surfaceId=</span><span class="s">&quot;flowchartSurface&quot;</span> <span class="na">jtkId=</span><span class="s">&quot;flowchart&quot;</span> <span class="err">[view]=&quot;view&quot;</span> <span class="err">[renderParams]=&quot;renderParams&quot;</span> <span class="err">[toolkitParams]=&quot;toolkitParams&quot;</span> <span class="err">[nodeResolver]=&quot;nodeResolver&quot;</span><span class="nt">&gt;&lt;/jsplumb-toolkit&gt;</span>
<span class="nt">&lt;jsplumb-miniview</span> <span class="na">surfaceId=</span><span class="s">&quot;flowchartSurface&quot;</span><span class="nt">&gt;&lt;/jsplumb-miniview&gt;</span>
</code></pre></div>
<p>The template uses all 3 components offered by the Toolkit&#39;s Angular 2 integration: a Toolkit instance (and associated Surface), a Miniview, 
and a palette from which new items can be dragged onto the canvas.</p>

<p>Points to note:</p>

<ul>
<li>The first div in the template is a Toolkit <code>palette</code> component. In Angular 2 components are identified by a <code>selector</code>, which needs only
to be a valid CSS3 selector. The <code>palette</code> component&#39;s selector is <code>[jsplumb-palette]</code>, so the first div is considered to be a Palette
component.</li>
<li>The palette is given the ID of the Surface to attach itself to (see below)</li>
<li><p>The palette is passed in a <code>typeExtractor</code> using &quot;square bracket&quot; syntax, which means in this case that the demo component
declares a method called <code>typeExtractor</code> (whose job is to return the type of some dropped item, given the related DOM element).</p></li>
<li><p>The jsplumb-toolkit<code>component is assigned a local ID of</code>toolkit<code>; we capture this as a</code>ViewChild` in the demo component.</p></li>
<li><p>We pass in both <code>renderParams</code> (parameters for the Surface constructor) and <code>toolkitParams</code> (parameters for the Toolkit constructor)
to the <code>jsplumb-toolkit</code> component. We also provide a <code>nodeResolver</code>, whose job it is to map node types to components.</p></li>
<li><p>We assign a <code>surfaceId</code> and a <code>jtkId</code> to the Toolkit component. <code>jtkId</code>, the Toolkit&#39;s ID, is not actually used in this demo. But the
<code>surfaceId</code> is used by the Palette and Miniview components.</p></li>
<li><p>We provide the ID of the Surface to attach the <code>jsplumb-miniview</code> to.</p></li>
</ul>

<p><a href="#top">TOP</a></p>

<hr>

<p><a name="toolkitParams"></a></p>

<h3>Toolkit Parameters</h3>

<p>The parameters passed in to the Toolkit&#39;s constructor are:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">toolkitParams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">nodeFactory</span><span class="o">:</span><span class="p">(</span><span class="nx">type</span><span class="o">:</span><span class="nx">string</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span><span class="nx">any</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span><span class="nb">Function</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
                <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgText&quot;</span><span class="p">,</span>
                <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Enter &quot;</span> <span class="o">+</span> <span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; name:&quot;</span><span class="p">,</span>
                <span class="nx">onOK</span><span class="o">:</span> <span class="p">(</span><span class="nx">d</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
                    <span class="c1">// if the user entered a name...</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// and it was at least 2 chars</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                            <span class="c1">// set width and height.</span>
                            <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodeDimensions</span><span class="p">[</span><span class="nx">type</span><span class="p">]);</span>
                            <span class="c1">// set an id and continue.</span>
                            <span class="nx">data</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">jsPlumbToolkitUtil</span><span class="p">.</span><span class="nx">uuid</span><span class="p">();</span>
                            <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                        <span class="c1">// else advise the user.</span>
                            <span class="nx">alert</span><span class="p">(</span><span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; names must be at least 2 characters!&quot;</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="c1">// else...do not proceed.</span>
                <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">beforeStartConnect</span><span class="o">:</span><span class="p">(</span><span class="nx">node</span><span class="o">:</span><span class="nx">any</span><span class="p">,</span> <span class="nx">edgeType</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span> <span class="nx">label</span><span class="o">:</span><span class="s2">&quot;...&quot;</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a name="renderParams"></a></p>

<h3>Surface Parameters</h3>

<p>The parameters passed in to the Surface&#39;s constructor are:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">renderParams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">layout</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span><span class="s2">&quot;Spring&quot;</span>
    <span class="p">},</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">canvasClick</span><span class="o">:</span> <span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="nx">Event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">clearSelection</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="nx">edgeAdded</span><span class="o">:</span><span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">addedByMouse</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">editLabel</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">modeChanged</span><span class="o">:</span><span class="p">(</span><span class="nx">mode</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">controls</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.controls&quot;</span><span class="p">);</span>
            <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">controls</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;[mode]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
            <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">controls</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;[mode=&#39;&quot;</span> <span class="o">+</span> <span class="nx">mode</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">consumeRightClick</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
    <span class="nx">dragOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">filter</span><span class="o">:</span> <span class="s2">&quot;.jtk-draw-handle, .node-action, .node-action i&quot;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a name="view"></a></p>

<h3>View</h3>

<p>The view contains the definitions of node/edge appearance and behaviour:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">view</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">nodes</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;start&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;StartNode&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;selectable&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">tap</span><span class="o">:</span> <span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">toggleSelection</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">node</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;question&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
            <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;QuestionNode&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;output&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
            <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;OutputNode&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;action&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;selectable&quot;</span><span class="p">,</span>
            <span class="nx">template</span><span class="o">:</span><span class="s2">&quot;ActionNode&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">edges</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;default&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">anchor</span><span class="o">:</span><span class="s2">&quot;AutoDefault&quot;</span><span class="p">,</span>
            <span class="nx">endpoint</span><span class="o">:</span><span class="s2">&quot;Blank&quot;</span><span class="p">,</span>
            <span class="nx">connector</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Flowchart&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">cornerRadius</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="p">],</span>
            <span class="nx">paintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">strokeWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">stroke</span><span class="o">:</span> <span class="s2">&quot;#f76258&quot;</span><span class="p">,</span> <span class="nx">outlineWidth</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">outlineStroke</span><span class="o">:</span> <span class="s2">&quot;transparent&quot;</span> <span class="p">},</span>   <span class="c1">//  paint style for this edge type.</span>
            <span class="nx">hoverPaintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">strokeWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">stroke</span><span class="o">:</span> <span class="s2">&quot;rgb(67,67,67)&quot;</span> <span class="p">},</span> <span class="c1">// hover paint style for this edge type.</span>
            <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;dblclick&quot;</span><span class="o">:</span> <span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
                        <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgConfirm&quot;</span><span class="p">,</span>
                        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                            <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;Delete Edge&quot;</span>
                        <span class="p">},</span>
                        <span class="nx">onOK</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">removeEdge</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span> <span class="p">}</span>
                    <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">overlays</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">[</span> <span class="s2">&quot;Arrow&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">location</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">length</span><span class="o">:</span> <span class="mi">10</span> <span class="p">}],</span>
                <span class="p">[</span> <span class="s2">&quot;Arrow&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">location</span><span class="o">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">length</span><span class="o">:</span> <span class="mi">10</span> <span class="p">}]</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;connection&quot;</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
            <span class="nx">overlays</span><span class="o">:</span><span class="p">[</span>
                <span class="p">[</span>
                    <span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">label</span><span class="o">:</span> <span class="s2">&quot;${label}&quot;</span><span class="p">,</span>
                    <span class="nx">events</span><span class="o">:</span><span class="p">{</span>
                        <span class="nx">click</span><span class="o">:</span><span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">editLabel</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">ports</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;start&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">endpoint</span><span class="o">:</span> <span class="s2">&quot;Blank&quot;</span><span class="p">,</span>
            <span class="nx">anchor</span><span class="o">:</span> <span class="s2">&quot;Continuous&quot;</span><span class="p">,</span>
            <span class="nx">uniqueEndpoint</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">edgeType</span><span class="o">:</span> <span class="s2">&quot;default&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;source&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">endpoint</span><span class="o">:</span> <span class="s2">&quot;Blank&quot;</span><span class="p">,</span>
            <span class="nx">paintStyle</span><span class="o">:</span> <span class="p">{</span><span class="nx">fill</span><span class="o">:</span> <span class="s2">&quot;#84acb3&quot;</span><span class="p">},</span>
            <span class="nx">anchor</span><span class="o">:</span> <span class="s2">&quot;AutoDefault&quot;</span><span class="p">,</span>
            <span class="nx">maxConnections</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="nx">edgeType</span><span class="o">:</span> <span class="s2">&quot;connection&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;target&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">maxConnections</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="nx">endpoint</span><span class="o">:</span> <span class="s2">&quot;Blank&quot;</span><span class="p">,</span>
            <span class="nx">anchor</span><span class="o">:</span> <span class="s2">&quot;AutoDefault&quot;</span><span class="p">,</span>
            <span class="nx">paintStyle</span><span class="o">:</span> <span class="p">{</span><span class="nx">fill</span><span class="o">:</span> <span class="s2">&quot;#84acb3&quot;</span><span class="p">},</span>
            <span class="nx">isTarget</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p><a name="initialisation"></a></p>

<h3>Initialisation</h3>

<p>The <code>ngAfterViewInit</code> method of the demo component looks like this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">toolkit</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">surface</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">surface</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">controls</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.controls&quot;</span><span class="p">);</span>
<span class="c1">// pan mode/select mode</span>
<span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">controls</span><span class="p">,</span> <span class="s2">&quot;tap&quot;</span><span class="p">,</span> <span class="s2">&quot;[mode]&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">surface</span><span class="p">.</span><span class="nx">setMode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// on home button click, zoom content to fit.</span>
<span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">controls</span><span class="p">,</span> <span class="s2">&quot;tap&quot;</span><span class="p">,</span> <span class="s2">&quot;[reset]&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">toolkit</span><span class="p">.</span><span class="nx">clearSelection</span><span class="p">();</span>
    <span class="nx">surface</span><span class="p">.</span><span class="nx">zoomToFit</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// configure Drawing tools.</span>
<span class="k">new</span> <span class="nx">DrawingTools</span><span class="p">({</span>
    <span class="nx">renderer</span><span class="o">:</span> <span class="nx">surface</span>
<span class="p">});</span>

<span class="c1">// ---------------- update data set -------------------------</span>
<span class="kd">var</span> <span class="nx">_syntaxHighlight</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">json</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">json</span> <span class="o">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span> <span class="o">+</span> <span class="nx">json</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(&quot;(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\&quot;])*&quot;(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cls</span> <span class="o">=</span> <span class="s1">&#39;number&#39;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/^&quot;/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">match</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="sr">/:$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">match</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">cls</span> <span class="o">=</span> <span class="s1">&#39;key&#39;</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">cls</span> <span class="o">=</span> <span class="s1">&#39;string&#39;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="sr">/true|false/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">match</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">cls</span> <span class="o">=</span> <span class="s1">&#39;boolean&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="sr">/null/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">match</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">cls</span> <span class="o">=</span> <span class="s1">&#39;null&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;span class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">cls</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">match</span> <span class="o">+</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">;</span>
    <span class="p">})</span> <span class="o">+</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">toolkit</span><span class="p">.</span><span class="nx">load</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span><span class="s2">&quot;data/flowchart-1.json&quot;</span><span class="p">,</span>
    <span class="nx">onload</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">surface</span><span class="p">.</span><span class="nx">centerContent</span><span class="p">();</span>
        <span class="nx">surface</span><span class="p">.</span><span class="nx">repaintEverything</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a name="loading"></a></p>

<h3>Data Loading</h3>

<p>Data for this application is stored in <code>data/flowchart-1.json</code> inside the application folder. It is loaded by this 
code inside the <code>ngAfterViewInit</code> function of the demo component:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">toolkit</span><span class="p">.</span><span class="nx">load</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span><span class="s2">&quot;data/flowchart-1.json&quot;</span><span class="p">,</span>
    <span class="nx">onload</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">surface</span><span class="p">.</span><span class="nx">centerContent</span><span class="p">();</span>
        <span class="nx">surface</span><span class="p">.</span><span class="nx">repaintEverything</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a name="dragging"></a></p>

<h3>Dragging New Nodes</h3>

<p>As discussed above, a <code>jsplumb-palette</code> is declared, which configures all of its child <code>li</code> elements to be droppable onto
the Surface canvas.  When a drop occurs, the type of the newly dragged node is calculated by the <code>typeExtractor</code> 
method  declared on the demo component:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">typeExtractor</span><span class="p">(</span><span class="nx">el</span><span class="o">:</span><span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;jtk-node-type&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a name="behaviour"></a></p>

<h3>Behaviour</h3>

<p>In the original FlowchartBuilder demo, there are three pieces of behaviour that we need to code that are not 
completely handled for us by the Toolkit:  </p>

<ul>
<li>Edit Node Text</li>
<li>Delete Node</li>
<li>Remove Edge</li>
</ul>

<p>These exist in this Angular demo, too, but, for Nodes, are handled slightly differently.  Each Node is declared a Component 
specific to the Node type. Every component extends BaseNodeComponent; the <code>action</code>, <code>output</code> and <code>question</code> nodes also
extend <code>BaseEditableNodeComponent</code>, which is the component containing the edit methods.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">class</span> <span class="nx">BaseNodeComponent</span> <span class="p">{</span>
    <span class="nx">toolkit</span><span class="o">:</span><span class="nx">jsPlumbToolkit</span>
    <span class="nx">surface</span><span class="o">:</span><span class="nx">Surface</span>
    <span class="nx">_el</span><span class="o">:</span><span class="nx">any</span>

    <span class="nx">ngAfterViewInit</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">surface</span><span class="p">.</span><span class="nx">getJsPlumb</span><span class="p">().</span><span class="nx">revalidate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_el</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kr">class</span> <span class="nx">BaseEditableNodeComponent</span> <span class="kr">extends</span> <span class="nx">BaseNodeComponent</span> <span class="p">{</span>

    <span class="nx">removeNode</span> <span class="p">(</span><span class="nx">node</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">surface</span><span class="p">.</span><span class="nx">getObjectInfo</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
            <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgConfirm&quot;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;Delete &#39;&quot;</span> <span class="o">+</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="p">},</span>
            <span class="nx">onOK</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">removeNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">editNode</span><span class="p">(</span><span class="nx">node</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">surface</span><span class="p">.</span><span class="nx">getObjectInfo</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
            <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgText&quot;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Edit &quot;</span> <span class="o">+</span> <span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s2">&quot; name&quot;</span><span class="p">,</span>
            <span class="nx">onOK</span><span class="o">:</span> <span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// if name is at least 2 chars long, update the underlying data and</span>
                    <span class="c1">// update the UI.</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">updateNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>To digress quickly, the class signature and the <code>ngAfterViewInit</code> method here are required by all components that are acting as node renderers. This applies to your applications too. When you 
need to declare a new Node component you must ensure it does at least this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">class</span> <span class="nx">MyNodeComponent</span> <span class="p">{</span>
    <span class="nx">toolkit</span><span class="o">:</span><span class="nx">jsPlumbToolkit</span>
    <span class="nx">surface</span><span class="o">:</span><span class="nx">Surface</span>
    <span class="nx">_el</span><span class="o">:</span><span class="nx">any</span>

    <span class="nx">ngAfterViewInit</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">surface</span><span class="p">.</span><span class="nx">getJsPlumb</span><span class="p">().</span><span class="nx">revalidate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_el</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h6>Edit Node Text</h6>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-edit node-action&quot;</span> <span class="err">(click)=&quot;editNode(node)&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-pencil-square-o&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>The meat of the <code>editNode</code> method (shown above) is the same as that which the original FlowchartBuilder demo has; it&#39;s just the trigger to
launch the method that is different.</p>

<p>Note the <code>getObjectInfo</code> method: this is method with which you will want to acquaint yourself. It is defined on a 
Surface, not on a Toolkit instance, and takes a DOM element as argument and places it within the context of some object 
managed by the Toolkit instance that the Surface is associated with. In this case, the click event occurs on an 
icon. <code>getObjectInfo</code> traverses up the icon&#39;s ancestors until it finds an element that is associated with a Toolkit 
object - in our app, either a Table or View. When a Toolkit object is found, getObjectInfo returns an object with these 
values:</p>

<ul>
<li><strong>id</strong> ID of the Toolkit object</li>
<li><strong>obj</strong> The associated Toolkit object. May be a Node or a Port.</li>
<li><strong>el</strong> The DOM element for the Toolkit object</li>
<li><strong>type</strong> The type of the Toolkit object. This will be &quot;Node&quot; or &quot;Port&quot;.</li>
</ul>

<p>In this event handler, we show the user a dialog that will allow them to edit the Node&#39;s text. If the edited text is 
at least two character long we update the model.</p>

<p>This application uses the Toolkit&#39;s <a href="dialogs.html">dialogs</a> import to manage simple interactions with data members such as 
this. Your application may choose to use a different mechanism.</p>

<h6>Delete Node</h6>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;node-delete node-action&quot;</span> <span class="err">(click)=&quot;removeNode(obj)&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;fa fa-times&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div>
<p>Our Node components reference the <code>removeNode</code> method that is declared on the base class.</p>

<h6>Remove Edge</h6>

<p>This is handled in the same way by this demo as it is in the original FlowchartBuider.</p>

<p>We register a <code>dblclick</code> listener on edges by providing it as an event handler to the View, on the edge type that 
acts as the parent type for all others. First a helper method (on the demo component, not on Nodes as the previous two examples were):</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">removeEdge</span><span class="p">(</span><span class="nx">edge</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">removeEdge</span><span class="p">(</span><span class="nx">edge</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Then in the view:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">...</span>

<span class="nx">edges</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;default&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">connector</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Flowchart&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">cornerRadius</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="p">],</span>
    <span class="nx">paintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">lineWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">strokeStyle</span><span class="o">:</span> <span class="s2">&quot;#f76258&quot;</span><span class="p">,</span> <span class="nx">outlineWidth</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">outlineColor</span><span class="o">:</span> <span class="s2">&quot;transparent&quot;</span> <span class="p">},</span> 
    <span class="nx">hoverPaintStyle</span><span class="o">:</span> <span class="p">{</span> <span class="nx">lineWidth</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">strokeStyle</span><span class="o">:</span> <span class="s2">&quot;rgb(67,67,67)&quot;</span> <span class="p">},</span> 
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;dblclick&quot;</span><span class="o">:</span> <span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
          <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgConfirm&quot;</span><span class="p">,</span>
          <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;Delete Edge&quot;</span>
          <span class="p">},</span>
          <span class="nx">onOK</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">removeEdge</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">});</span>
      <span class="p">}</span>
   <span class="p">},</span>

<span class="p">...</span>
</code></pre></div>
<h6>Editing Edge Label</h6>

<p>All Edges except those from a <em>Start</em> node are set to be of type <code>connection</code>, which is defined in the view as follows:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">&quot;connection&quot;</span><span class="o">:</span><span class="p">{</span>
  <span class="nx">parent</span><span class="o">:</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
  <span class="nx">overlays</span><span class="o">:</span><span class="p">[</span>
    <span class="p">[</span> <span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">label</span><span class="o">:</span> <span class="s2">&quot;${label}&quot;</span><span class="p">,</span>
      <span class="nx">events</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">click</span><span class="o">:</span><span class="p">(</span><span class="nx">params</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">editLabel</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">edge</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}]</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>We define a <code>click</code> event handler on the Label overlay which edits the label for the Edge.</p>

<p>The helper function is:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">editLabel</span><span class="p">(</span><span class="nx">edge</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
        <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;dlgText&quot;</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">text</span><span class="o">:</span> <span class="nx">edge</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">label</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span>
        <span class="p">},</span>
        <span class="nx">onOK</span><span class="o">:</span> <span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">updateEdge</span><span class="p">(</span><span class="nx">edge</span><span class="p">,</span> <span class="p">{</span> <span class="nx">label</span><span class="o">:</span><span class="nx">data</span><span class="p">.</span><span class="nx">text</span> <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a id="resizedrag"></a></p>

<h3>Resizing/Dragging Nodes</h3>

<p>To resize or drag a node first you must either click on it, or use the lasso (described <a href="#selecting">below</a>) to select 
it.  A selected node looks like this:</p>

<p><img src="flowchart-selected-node.png" alt="Selected Node"></p>

<p>The dotted line and drag handles that are added to a selected Node are put there by the Tookit&#39;s drawing tools. It 
listens to the Toolkit&#39;s select/deselect events and 
decorates UI elements accordingly. These tools are discussed in detail on <a href="drawing.html">this page</a>.</p>

<p>The drawing tools are initialized with this line of code (inside the <code>ngAfterViewInit</code> of the demo component):</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">DrawingTools</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;jsplumbtoolkit&quot;</span>

<span class="p">...</span>

<span class="k">new</span> <span class="nx">DrawingTools</span><span class="p">({</span>
    <span class="nx">renderer</span><span class="o">:</span> <span class="nx">surface</span>
<span class="p">});</span>
</code></pre></div>
<p>You pass them the instance of the Surface widget you&#39;re working with.</p>

<h4>Dragging</h4>

<p>Nodes can be dragged only by the square in the center of the node. This is achieved by setting a <code>filter</code> on the 
<code>dragOptions</code> parameter on the <code>render</code> call:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">dragOptions</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">handle</span><span class="o">:</span> <span class="s2">&quot;.jtk-draw-drag&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p><code>jtk-draw-drag</code> is the classname of the square that the drawing tools place in the center of a selected node.</p>

<h4>Resizing</h4>

<p>Resizing is handled automatically by the drawing tools.  By default, these tools will change the <code>w</code>, <code>h</code>, <code>left</code> and <code>top</code> values in a node&#39;s data, but this can be changed.</p>

<p>When a node&#39;s data is updated the drawing tools call the appropriate update method on the underlying Toolkit. The changes 
will be reflected immediately in the DOM.</p>

<p><a href="#top">TOP</a></p>

<hr>

<p><a id="selecting"></a></p>

<h3>Selecting Nodes</h3>

<h5>Left Click</h5>

<p>Nodes can be selected with a left-click (or tap on a touch device; <code>tap</code> is a better event to choose in general because the
Toolkit abstracts out the difference between mouse devices and touch devices and presents <code>click</code> events as <code>tap</code> events
on non touch devices).  This is configured in the <code>view</code> parameter to the <code>render</code> call. In this application, 
Nodes of type <em>selectable</em> have the capability enabled with this code:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">&quot;selectable&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">tap</span><span class="o">:</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">toggleSelection</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">node</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>tap</code> event (discussed <a href="widget-surface.html#eventlist">here</a>) is preferable to <code>click</code>, as it ensures the application responds only to true clicks on devices with a mouse, and also avoids the delay that some vendors introduce to a click event on touch devices.</p>

<h5>Lasso Selection</h5>

<p>Lasso selection is enabled by default on the Surface widget. </p>

<p>To activate the lasso, click the pencil icon in the toolbar:</p>

<p><img src="select-lasso.png" alt="Lasso Select Mode"></p>

<p>The code that listens to clicks on this icon is as follows:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">modeChanged</span><span class="o">:</span><span class="p">(</span><span class="nx">mode</span><span class="o">:</span><span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">controls</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.controls&quot;</span><span class="p">);</span>
        <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">controls</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;[mode]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
        <span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">controls</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;[mode=&#39;&quot;</span> <span class="o">+</span> <span class="nx">mode</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">),</span> <span class="s2">&quot;selected-mode&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>In this application, <code>events</code> is declared in the <code>renderParams</code> method of the main demo component. </p>

<p>The code that listens for clicks on the mode buttons is in the <code>ngAfterViewInit</code> method of the demo component:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// pan mode/select mode</span>
<span class="kr">const</span> <span class="nx">toolkit</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">surface</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">surface</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">controls</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.controls&quot;</span><span class="p">);</span>
<span class="c1">// pan mode/select mode</span>
<span class="nx">jsPlumb</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">controls</span><span class="p">,</span> <span class="s2">&quot;tap&quot;</span><span class="p">,</span> <span class="s2">&quot;[mode]&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">surface</span><span class="p">.</span><span class="nx">setMode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div>
<p>Here we&#39;ve registered an event listener to be informed when the Surface&#39;s mode has changed; it is responsible for setting the appropriate classes on the toolbar items.  The click listener 
extracts the desired mode from the button that was clicked and sets it on the renderer.</p>

<h5>Lasso Operation</h5>

<p>The lasso works in two ways: when you drag from left to right, any node that intersects your lasso will be selected.  When you drag from right to left, only nodes that are enclosed by your 
lasso will be selected.</p>

<p><img src="lasso-select-operation.png" alt="Lasso Operation"></p>

<h5>Exiting Select Mode</h5>

<p>The Surface widget automatically exits select mode once the user has selected something. In this application we also listen to clicks on the whitespace in the widget and switch back to pan mode when we detect one. This is the <code>events</code> argument to the <code>render</code> call:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="nx">canvasClick</span><span class="o">:</span> <span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="nx">Event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">toolkitComponent</span><span class="p">.</span><span class="nx">toolkit</span><span class="p">.</span><span class="nx">clearSelection</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p><code>clearSelection</code> clears the current selection and switches back to Pan mode.  <code>this</code> here refers to the demo component, inside which the jsPlumb Toolkit component is captured using
Angular 2&#39;s <code>ViewChild</code> concept:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="err">@</span><span class="nx">ViewChild</span><span class="p">(</span><span class="nx">jsPlumbToolkitComponent</span><span class="p">)</span> <span class="nx">toolkitComponent</span><span class="o">:</span><span class="nx">jsPlumbToolkitComponent</span><span class="p">;</span>
</code></pre></div>
<p><a href="#top">TOP</a></p>

<hr>

<p><a id="dialogs"></a></p>

<h3>Dialogs</h3>

<p>The dialogs used in this app are part of the jsPlumb Toolkit core. They provide a simple abstraction around the business of getting input from the user and dealing 
with it; they&#39;re not necessarily fully-featured enough for all applications.</p>

<h4>Initialization</h4>

<p>To initialize the dialogs, we call <code>jsPlumbToolkit.Dialogs.initialize</code>, with an appropriate selector for the templates for your dialogs (see below for an explanation of this). In this 
application we do this in the constructor of the application module (<code>src/app.module.ts</code>):</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Dialogs</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;jsplumbtoolkit&quot;</span>

<span class="p">...</span>

<span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{</span> 
    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// initialize dialogs</span>
        <span class="nx">Dialogs</span><span class="p">.</span><span class="nx">initialize</span><span class="p">({</span>
            <span class="nx">selector</span><span class="o">:</span> <span class="s2">&quot;.dlg&quot;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4>Templates</h4>

<p>Each dialog has a template in the HTML, with some class name that you matched in the <code>selector</code> argument to the <code>initialize</code> call above:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;jtk&quot;</span> <span class="na">class=</span><span class="s">&quot;dlg&quot;</span> <span class="na">id=</span><span class="s">&quot;dlgViewQuery&quot;</span> <span class="na">title=</span><span class="s">&quot;Edit Query&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">&quot;txtViewQuery&quot;</span> <span class="err">jtk-focus</span> <span class="na">jtk-att=</span><span class="s">&quot;query&quot;</span><span class="nt">&gt;</span>${query}<span class="nt">&lt;/textarea&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<h5>Binding Parameters</h5>

<p>These templates use the same template engine as the Surface renderer, so in this example you can see we&#39;ve extracted <code>query</code> from the View node&#39;s data, and injected it into the textarea. But what might not be immediately obvious is the purpose of the <code>jtk-att</code> attribute: it tells the dialog handler that the value of this textarea should be passed to the OK handler, using the key <code>query</code>.</p>

<p>Note also in the above example, the <code>jtk-focus</code> attribute: this tells the dialog handler that the textarea should be given the focus when the dialog first opens.</p>

<h4>Showing a dialog</h4>

<p>This example is the dialog that is shown when you edit a View query. We provide the id of the template to use for the dialog, and we provide the View node&#39;s data as the backing data for the dialog. Then we provide an <code>onOK</code> callback:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">Dialogs</span><span class="p">.</span><span class="nx">show</span><span class="p">({</span>
  <span class="nx">id</span><span class="o">:</span><span class="s2">&quot;dlgViewQuery&quot;</span><span class="p">,</span>
  <span class="nx">data</span><span class="o">:</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
  <span class="nx">onOK</span><span class="o">:</span><span class="p">(</span><span class="nx">data</span><span class="o">:</span><span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// update data</span>
    <span class="nx">toolkit</span><span class="p">.</span><span class="nx">updateNode</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="c1">// update UI                    </span>
    <span class="nx">info</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.view-details&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>The <code>data</code> argument to the <code>onOK</code> callback consists of an object whose key value pairs are determined by the <code>jtk-att</code> attributes found in the template. Recall that above we had a textarea with <code>jtk-att:&quot;query&quot;</code>. This means that the <code>data</code> argument to <code>onOK</code> looks like this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="nx">query</span><span class="o">:</span><span class="s2">&quot;the contents of the text area&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h5>Supported Input Types</h5>

<p>The list of supported input types is:</p>

<ul>
<li>text</li>
<li>radio button(s) </li>
<li>checkbox</li>
<li>select</li>
<li>textarea</li>
</ul>

<h5>Dialog Titles</h5>

<p>If you set a <code>title</code> attribute on a dialog&#39;s template, that value will be used for the title of the dialog. 
Alternatively, you can provide a <code>title</code> parameter to the <code>show</code> call.</p>

<h5>Lifecycle Callbacks</h5>

<p>There are three lifecycle callbacks supported:</p>

<ul>
<li><strong>onOpen</strong> Called when the dialog has been opened. The related DOM element for the dialog is passed to this method.</li>
<li><strong>onOK</strong> Called when the user presses OK. The callback is provided a data object as discussed above.</li>
<li><strong>onCancel</strong> Called when the user presses cancel. No arguments are provided to the callback.</li>
</ul>

<p><a href="#top">TOP</a></p>

                </div>
            </div>
        </div>

    </body>

</html>
